<%if params.has_key?(:using_brownie_point) %>
  $("#brownie_point").html("<%= escape_javascript(render(partial: "carts/brownie_point", locals: {current_user: current_user, cart: @cart, cart_data: @cart_data})) %>")
<% else %>
  <% if @coupon && !@coupon.errors.any? %>
    CouponUtil.removeDiscountSection();
    <% if @coupon.is_cashback_coupon? %>
      $('hr.coupon-section').after("<%= escape_javascript(render(partial: "carts/cashback", locals: {cashback: @cashback})) %>")
    <% else %>
      $('hr.coupon-section').after("<%= escape_javascript(render(partial: "carts/discount", locals: {discount: @discount})) %>")
    <% end %>
    $("#coupon_section").html("<%= escape_javascript(render(partial: "carts/coupon_section", locals: {coupon: @coupon})) %>")
    <% if params.has_key?(:coupon) %>
      $("#messages").html("<%= escape_javascript(render(partial: "shared/alert_msg", locals: {msg: get_coupon_message_and_type(@coupon)[:message], msg_type: get_coupon_message_and_type(@coupon)[:type]})) %>") 
    <% end %>
  <% elsif @coupon && @coupon.errors.any? %>
    $("#messages").html("<%= escape_javascript(render(partial: "shared/alert_msg", locals: {msg: get_coupon_message_and_type(@coupon)[:message], msg_type: get_coupon_message_and_type(@coupon)[:type]})) %>")
  <% elsif @coupon.blank? && params.has_key?(:coupon) %>
    $("#messages").html("<%= escape_javascript(render(partial: "shared/alert_msg", locals: {msg: t('coupon.coupon_invalid'), msg_type: t('message_type.danger') })) %>")
  <% end %>
  $('#total').html("<%= currency_rate_with_symbol(@country_rate, @sub_total) %>")
  <% if quantity_changed?(params) %>
    $(".cart-text").html("<%= escape_javascript(render 'layouts/cart_text') %>")
    $("#messages").html("<%= escape_javascript(render(partial: "shared/alert_msg", locals: {msg: flash[:notice], msg_type: t('message_type.success')})) %>")
    CartUtil.setItemQtyAndItemTotal('<%= CartItem.get_cart_item_qty_and_total_hash(@cart_items) %>')
  <% end %>
<% end %>
$('#grand_total').html("<%= currency_rate_with_symbol(@country_rate, @grand_total) %>")